# 647.回文子串

https://leetcode-cn.com/problems/palindromic-substrings/

![](https://cdn.jsdelivr.net/gh/River-Cold/pictureBed/vuepress-blog/interview/basics/network/20220307100613.png)



## 方法一：中心扩散

### 思路分析

::: tip

考虑回文长度是奇数和回文长度是偶数的两种情况。如果回文长度是奇数，那么回文中心是一个字符；如果回文长度是偶数，那么中心是两个字符。

所以可以枚举所有的回文中心，然后从中心向两边扩散，当寻找完所有的回文中心之后，问题就会解决。

假设字符串`s`长度为`len`，则回文中心一共有`2*len-1`个，包括`len`个单字符和`len-1`个双字符。

:::

### 参考代码

:::: code-group

::: code-group-item c++

```cpp
class Solution {
public:
    int countSubstrings(string s) {
        // 中心扩展法
        int n = s.length();
        int ans = 0;
        for(int center = 0; center < n; center++){
            // 一个字符作中心
            int left = center, right = center;
            while(left >= 0 && right < n && s[left] == s[right]){
                left--;
                right++;
                ans++;
            }
            // 两个字符作中心
            left = center, right = center + 1;
            while(left >= 0 && right < n && s[left] == s[right]){
                left--;
                right++;
                ans++;
            }    
        }
        return ans;
    }
};
```

:::

::::

## 方法二：动态规划

::: tip

**状态定义**：

设`dp[i][j]`表示字符串`s`在`[i,j]`区间的子串是否是一个回文串

**状态转移方程**：
$$
\begin{align}
&if(j - i \leq {2}) \\
&dp[i][j] = (s[i]==s[j])\ and\ dp[i + 1][j - 1] \\
&else \\
&dp[i][j] = (s[i]==s[j])
\end{align}
$$
**边界条件**：

`dp[i][j]` 表示 `[i,j]` 子串是否是回文串，判断该子串是否是回文串需要两个条件：

1. `s[i] == s[j]` 
2. 掐头去尾看是否还是回文，即 `dp[i+1][j-1]` 是否是回文。意思就是 `dp[i][j]` 需要 `dp[i+1][j-1]` 来判断，即当前元素需要它的左下角元素来判断。正常我们是 `for i` 里面套 `for j`，这样循环是一层一层的，就出现了矛盾，即求 `dp[i][j]` 的时候 `dp[i+1][j-1]` 此时还是未知的

:::

```cpp
class Solution {
public:
    int countSubstrings(string s) {
        int n = s.size();
        int cnt = 0;
        vector<vector<int>> dp(n, vector<int>(n, false));
        for(int j = 0; j < n; j++){
            for(int i = 0; i <= j; i++){
                if(j - i > 2){
                    dp[i][j] = (s[i] == s[j]) && dp[i + 1][j - 1];
                }else{
                    dp[i][j] = (s[i] == s[j]);
                }
                if(dp[i][j] == true){
                    cnt++;
                }
            }
        }
        return cnt;
    }
};
```

:::

::::

## 参考文献

[两道回文子串的解法（详解中心扩展法） - 回文子串 - 力扣（LeetCode） (leetcode-cn.com)](https://leetcode-cn.com/problems/palindromic-substrings/solution/liang-dao-hui-wen-zi-chuan-de-jie-fa-xiang-jie-zho/)